#!/bin/bash

function ddm_help {
  echo "========================================================================"
  echo "You can install proprietary drivers from terminal with these parameters:"
  echo "========================================================================"
  echo "--help / -h     this screen."
  echo "-open           remove proprietary drivers and install open drivers."
  echo "-ati            install ATI drivers."
  echo "-nvidia         install Nvidia drivers."
  echo "-broadcom       install Broadcom drivers."
  echo "-pae            install PAE kernel for 32-bit systems."
  echo "-fixbumblebee   fix bumblebee when bumblebee broke after installation."
  echo "==============================================================="
}

function done_msg {
  echo
  echo "Done - please, reboot your system."
}

case $1 in
    -open)
        sudo install-open
        done_msg
        ;;
    -ati)
        sudo install-ati
        done_msg
        ;;
    -nvidia)
        sudo install-nvidia
        done_msg
        ;;
    -broadcom)
        sudo install-broadcom
        done_msg
        ;;
    -pae)
        sudo install-pae
        done_msg
        ;;
    -fixbumblebee)
        sudo fixbumblebee
        done_msg
        ;;
    -h)
        ddm_help
        ;;
    --help)
	ddm_help
        ;;
    *)
        optimize='OO'; case "$*" in *--debug*) unset optimize; esac
	# Launch ddm with all passed arguments (future reserved)

	MSG='Please enter your password'
	CMD="python3 -tt${optimize} /usr/lib/ddm/main.py $@"
	if [ -e "/usr/bin/kdesudo" ]; then
	  kdesudo -i "ddm" -d --comment "<b>$MSG</b>" "$CMD"
	else
	  gksudo --message "<b>$MSG</b>" "$CMD"
	fi
esac
